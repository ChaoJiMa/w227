<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/js/bootstrap-3.3.7/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/jquery.mCustomScrollbar.min.css" />
    <link rel="stylesheet" href="/css/custom.css">
    <!-- <link rel="stylesheet" href="/css/normalize.css"> -->
    <link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="/js/jquery-3.5.1.js"></script>
    <script src="/js/bootstrap-3.3.7/dist/js/bootstrap.min.js"></script>
    <style>
        .yanse{
            font-size: calc(0.6em + 1.5vw);
            color: rgb(119,119,119);
        }
        #xuanran{
            color: black;
            font-size: calc(0.1em + 0.6vw)
        }
        #dataTable table tr:hover td { background-color: palegoldenrod; }
        .bb{
            position: relative;
        }
        .tj{
            position: absolute;
            bottom: 50%;
            display: none;
            background-color: aliceblue;
            padding: 20px;
         
            border-radius: 10px;
        }
        .tj div p{
            margin: 0 0 8px 0;
        }
        .tj div input{
            margin: 0 0 2px 0;
        }
        .tjm{
            position: absolute;
            bottom: 50%;
            display: none;
            background-color: aliceblue;
            padding: 20px;
         
            border-radius: 10px;
        }
        .tjm div p{
            margin: 0 0 8px 0;
        }
        .tjm div input{
            margin: 0 0 2px 0;
        }

        .tjmm{
            position: absolute;
            bottom: 50%;
            display: none;
            background-color: aliceblue;
            padding: 20px;
         
            border-radius: 10px;
        }
        .tjmm div p{
            margin: 0 0 8px 0;
        }
        .tjmm div input{
            margin: 0 0 2px 0;
        }
    </style>
</head>
<body class="bb">
    <div class="page-wrapper">
        <nav id="sidebar" class="sidebar-wrapper">
          <div class="sidebar-content">
            <a href="#" id="toggle-sidebar"><i class="fa fa-bars"></i></a>
            <div class="sidebar-brand">
                <a href="#">管理系统</a>
            </div>
            <div class="sidebar-header">
                <div class="user-pic">
                    <img  src="/img/touxiang.png" alt="" id="tx">
                </div>
                <div class="user-info">
                    <span class="user-name" id="name">boss</span>
                    <span class="user-role" id="yhm">boss</span>
                    <div class="user-status">                       
                        <span class="label label-success" id="qx">权限</span>                          
                    </div>
                </div>
            </div><!-- sidebar-header  -->
            <div class="sidebar-menu">
                <ul>
                    <li class="header-menu"><span>菜单</span></li>
                    <li><a href="home.html"><i class="fa fa-tv"></i><span>首页</span></a></li>                     
                    <li class="sidebar-dropdown" id="xz">
                        <a href="#"><i class="fa fa-photo"></i><span>boss</span><span class="badge">2</span></a>
                        <div class="sidebar-submenu">
                            <ul>
                                <li><a href="boss1.html">功能一</a></li>
                                <li><a href="boss2.html">功能二</a></li>
                            </ul>
                        </div>
                    </li>
                    <li class="sidebar-dropdown" id="ls">
                        <a href="#"><i class="fa fa-bar-chart-o"></i><span>老师</span></a>
                        <div class="sidebar-submenu">
                            <ul>
                                <li><a href="ls1.html">submenu 1</a></li>
                                
                            </ul>
                        </div>
                    </li>
                    <li class="sidebar-dropdown" id="xs">
                        <a href="#"><i class="fa fa-diamond"></i><span>学生</span></a>
                        <div class="sidebar-submenu">
                            <ul>
                                <li><a href="xs1.html">submenu 1</a></li>
                                
                            </ul>
                        </div>
                    </li>
                    <li class="header-menu"><a href="login.html">退出</a></li>
                </ul>
               </div><!-- sidebar-menu  -->            
            </div><!-- sidebar-content  -->
        </nav><!-- sidebar-wrapper  -->
        <main class="page-content">
            <div class="col-xs-12" >
                <div class="col-xs-8">
                    <table class="col-xs-offset-3 table table-hover ">
                        <thead >
                            <tr>
                                <th>编号</th>
                                <th>姓名</th>
                                <th>用户名</th>
                                <th>性别</th>
                                <th>年龄</th>
                                <th>城市</th>
                                <th>手机</th>
                                <th>专业</th>
                                <th>班级</th>
                                <th>学号</th>
                                <th>成绩</th>
                                <th>
                                    <button class="btn btn-warning btn-xs" id="tianjia">添加</button>
                                    <button class="btn btn-danger btn-xs" id="shanchu">删除</button>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="xuanran">

                        </tbody>
                    </table>
                    <!-- 添加框 -->
                    <div class="tj col-xs-3 col-md-offset-7">
                        <div class="col-xs-4 ">
                            <p>姓名</p>
                            <p>用户名</p>
                            <p>性别</p>
                            <p>年龄</p>
                            <p>城市</p>
                            <p>手机</p>
                            <p>专业</p>
                            <p>班级</p>
                            <p>学号</p>
                            <p>成绩</p>
                            <button id="tjtj" onclick="wancheng()">提交</button>
                        </div>
                        <div class="col-xs-4 ">
                            <input type="text" name="" id="xm">
                            <input type="text" name="" id="yh">
                            <input type="text" name="" id="xb">
                            <input type="text" name="" id="nn">
                            <input type="text" name="" id="cs">
                            <input type="text" name="" id="sj">
                            <input type="text" name="" id="zy">
                            <input type="text" name="" id="bjj">
                            <input type="text" name="" id="xh">
                            <input type="text" name="" id="cj">
                            <button id="gb" onclick="guanbi()">关闭</button>  
                        </div>
                        
                    </div>
                    <!-- 查看框 -->
                        <div class="tjm col-xs-3 col-md-offset-7">
                            <div class="col-xs-4 ">
                                <p>姓名</p>
                                <p>用户名</p>
                                <p>性别</p>
                                <p>年龄</p>
                                <p>城市</p>
                                <p>手机</p>
                                <p>专业</p>
                                <p>班级</p>
                                <p>学号</p>
                                <p>成绩</p>
                            </div>
                            <div class="col-xs-4 ">
                                <input type="text" name="" id="xmm" readonly >
                                <input type="text" name="" id="yhmm" readonly >
                                <input type="text" name="" id="xbm" readonly >
                                <input type="text" name="" id="nnm" readonly >
                                <input type="text" name="" id="csm" readonly >
                                <input type="text" name="" id="sjm" readonly >
                                <input type="text" name="" id="zym" readonly >
                                <input type="text" name="" id="bjjm" readonly >
                                <input type="text" name="" id="xhm" readonly >
                                <input type="text" name="" id="cjm" readonly >
                                <button  onclick="guanbi()">关闭</button>  
                            </div>
                        </div>
                        <!-- 修改框 -->
                        <div class="tjmm col-xs-3 col-md-offset-7">
                            <div class="col-xs-4 ">
                                <p>姓名</p>
                                <p>用户名</p>
                                <p>性别</p>
                                <p>年龄</p>
                                <p>城市</p>
                                <p>手机</p>
                                <p>专业</p>
                                <p>班级</p>
                                <p>学号</p>
                                <p>成绩</p>
                                <button id="xgtj" onclick="xgwancheng()">提交</button>
                            </div>
                            <div class="col-xs-4 ">
                                <input type="text" name="" id="xmmm"  >
                                <input type="text" name="" id="yhmmm"  >
                                <input type="text" name="" id="xbmm"  >
                                <input type="text" name="" id="nnmm"  >
                                <input type="text" name="" id="csmm"  >
                                <input type="text" name="" id="sjmm"  >
                                <input type="text" name="" id="zymm"  >
                                <input type="text" name="" id="bjjmm"  >
                                <input type="text" name="" id="xhmm"  >
                                <input type="text" name="" id="cjmm"  >
                                <button  onclick="guanbi()">关闭</button>  
                            </div>
                        </div>
                </div>
            </div>
        </main>
        <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
        <script src="js/custom.js"></script>
        <script src="http://pv.sohu.com/cityjson"></script>
        <script type="text/javascript" src="js/home.js"></script>
        <script>
            var ymsj=JSON.parse(localStorage.getItem("ymsj"))
            var bianhao = 0;
            for(var i=0;i<ymsj.length;i++){
                bianhao++;
                var $trTemp = $('<tr></tr>')
                $trTemp.append("<td>"+ bianhao +"</td>")
                $trTemp.append("<td>"+ ymsj[i].name +"</td>")
                $trTemp.append("<td>"+ ymsj[i].yhm +"</td>")
                $trTemp.append("<td>"+ ymsj[i].sex +"</td>")
                $trTemp.append("<td>"+ ymsj[i].age +"</td>")
                $trTemp.append("<td>"+ ymsj[i].city +"</td>")
                $trTemp.append("<td>"+ ymsj[i].shou +"</td>")
                $trTemp.append("<td>"+ ymsj[i].zhuanye +"</td>")
                $trTemp.append("<td>"+ ymsj[i].bj +"</td>")
                $trTemp.append("<td id='xuehao'>"+ ymsj[i].number +"</td>")
                $trTemp.append("<td>"+ ymsj[i].cheng +"</td>")
                $trTemp.append('<td>'+'<button class="btn btn-success btn-xs" onclick="xiugai()">'+'修改'+'</button>' 
				+' '+'<button class="btn btn-info btn-xs"  onclick="chakan()">'+'查看'+'</button>'
				+'</td>')
                $trTemp.appendTo("#xuanran");
            }
            /*复选框*/
            $(function(){
                function initTableCheckbox() {
                    var $thr = $('table thead tr');
                    var $checkAllTh = $('<th><input type="checkbox" id="checkAll" name="checkAll" /></th>');
                    /*将全选/反选复选框添加到表头最前*/
                    $thr.prepend($checkAllTh);
                    /*“全选/反选”复选框*/
                    var $checkAll = $thr.find('input');
                    $checkAll.click(function(event){
                        /*将所有行的选中状态设成全选框的选中状态*/
                        $tbr.find('input').prop('checked',$(this).prop('checked'));
                        /*并调整所有选中行的CSS样式*/
                        if ($(this).prop('checked')) {
                            $tbr.find('input').parent().parent().addClass('xzhong');
                        } else{
                            $tbr.find('input').parent().parent().removeClass('xzhong');
                        }
                        /*阻止向上冒泡，以防再次触发点击操作*/
                        event.stopPropagation();
                    });
                    /*点击全选框所在单元格时也触发全选框的点击操作*/
                    $checkAllTh.click(function(){
                        $(this).find('input').click();
                    });
                    var $tbr = $('table tbody tr');
                    var $checkItemTd = $('<td><input type="checkbox" name="checkItem" /></td>');
                    /*每一行都在最前面插入一个选中复选框的单元格*/
                    $tbr.prepend($checkItemTd);
                    /*点击每一行的选中复选框时*/
                    $tbr.find('input').click(function(event){
                        /*调整选中行的CSS样式*/
                        $(this).parent().parent().toggleClass('xzhong');
                        
                        /*如果已经被选中行的行数等于表格的数据行数，将全选框设为选中状态，否则设为未选中状态*/
                        $checkAll.prop('checked',$tbr.find('input:checked').length == $tbr.length ? true : false);
                        /*阻止向上冒泡，以防再次触发点击操作*/
                        event.stopPropagation();
                    });
                    /*点击每一行时也触发该行的选中操作*/
                    $tbr.click(function(){
                        $(this).find('input').click();
                    });
                }
            initTableCheckbox();
        });

         /*删除*/
        $('#shanchu').click(function(){
            /*找到对应的学号*/
            var xuehao = $('#xuanran .xzhong').find('td').eq(10).html();
            // console.log($('#xuanran .xzhong').find('td').eq(10).html()) 
            //被选中删除
            for(i=0;i<ymsj.length;i++){
                if(xuehao ==ymsj[i].number){
                    ymsj.splice(i,1)
                    break;
                }
            }
            $('#xuanran .xzhong').remove()
            /*删除旧的*/
            localStorage.removeItem('ymsj');
            /*添加新的*/
            localStorage.setItem('ymsj', JSON.stringify(ymsj));
        })

        /*添加*/
        //显示模态框
        $('#tianjia').click(function(){
            $('.tj').find('input').val('');
            $('.tj').css('display','block')
        })
        //关闭
        function guanbi(){
            $('.tj').css('display','none')
            $('.tjm').css('display','none')
            $('.tjmm').css('display','none')
        }
        //完成
        function wancheng(){
            var name = $('#xm').val(),
                yhm = $('#yh').val(),
                sex = $('#xb').val(),
                age = $('#nn').val(),
                city = $('#cs').val(),
                shou = $('#sj').val(),
                zhuanye = $('#zy').val(),
                banji = $('#bjj').val(),
                number = $('#xh').val(),
                cheng = $('#cj').val();
            ymsj[ymsj.length]={
                name: name, 
                yhm:yhm,
                sex: sex,
                age: age,
                city: city,
                shou:shou,
                zhuanye: zhuanye,
                bj: banji, 
                number: number,
                cheng: cheng,
            }
            if(name|| yhm || sex ||age ||city||shou == ''){
                alert('主要信息不能为空')
            }else{
                localStorage.removeItem('ymsj');
                localStorage.setItem('ymsj', JSON.stringify(ymsj));
            }
            guanbi();
        }

        /*查看*/
        function chakan(){
                $('#xmm').val($('#xuanran .xzhong').find('td').eq(2).html()),
                $('#yhmm').val($('#xuanran .xzhong').find('td').eq(3).html()),
                $('#xbm').val($('#xuanran .xzhong').find('td').eq(4).html()),
                $('#nnm').val($('#xuanran .xzhong').find('td').eq(5).html()),
                $('#csm').val($('#xuanran .xzhong').find('td').eq(6).html()),
                $('#sjm').val($('#xuanran .xzhong').find('td').eq(7).html()),
                $('#zym').val($('#xuanran .xzhong').find('td').eq(8).html()),
                $('#bjjm').val($('#xuanran .xzhong').find('td').eq(9).html()),
                $('#xhm').val($('#xuanran .xzhong').find('td').eq(10).html()),
                $('#cjm').val($('#xuanran .xzhong').find('td').eq(11).html());
                $('.tjm').css('display','block')
        }
        /*修改*/
        function xiugai(){
                $('#xmmm').val($('#xuanran .xzhong').find('td').eq(2).html()),
                $('#yhmmm').val($('#xuanran .xzhong').find('td').eq(3).html()),
                $('#xbmm').val($('#xuanran .xzhong').find('td').eq(4).html()),
                $('#nnmm').val($('#xuanran .xzhong').find('td').eq(5).html()),
                $('#csmm').val($('#xuanran .xzhong').find('td').eq(6).html()),
                $('#sjmm').val($('#xuanran .xzhong').find('td').eq(7).html()),
                $('#zymm').val($('#xuanran .xzhong').find('td').eq(8).html()),
                $('#bjjmm').val($('#xuanran .xzhong').find('td').eq(9).html()),
                $('#xhmm').val($('#xuanran .xzhong').find('td').eq(10).html()),
                $('#cjmm').val($('#xuanran .xzhong').find('td').eq(11).html());
                $('.tjmm').css('display','block')
        }
        function xgwancheng(){
            var name=$('#xmmm').val(),
                yhm=$('#yhmmm').val(),
                sex=$('#xbmm').val(),
                age=$('#nnmm').val(),
                city=$('#csmm').val(),
                shou=$('#sjmm').val(),
                zhuanye=$('#zymm').val(),
                bj=$('#bjjmm').val(),
                number=$('#xhmm').val(),
                cheng=$('#cjmm').val();
                  
                var xuehao = $('#xuanran .xzhong').find('td').eq(10).html();
                var xia=0;
                for(i=0;i<ymsj.length;i++){
                    if(xuehao ==ymsj[i].number){
                        xia=i;
                        break;
                    }
                }
                console.log(xia)
                ymsj[xia]={
                    name: name, 
                    yhm:yhm,
                    sex: sex,
                    age: age,
                    city: city,
                    shou:shou,
                    zhuanye: zhuanye,
                    bj: bj, 
                    number: number,
                    cheng: cheng,
                }  
                console.log(ymsj)
                /*删除旧的*/
                localStorage.removeItem('ymsj'); 
                /*添加新的*/
                localStorage.setItem('ymsj', JSON.stringify(ymsj));
                guanbi();
        }
        </script>
</body>
</html>