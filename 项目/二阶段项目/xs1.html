<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/js/bootstrap-3.3.7/dist/css/bootstrap.min.css">
    
	<link rel="stylesheet" href="/css/jquery.mCustomScrollbar.min.css" />
    <link rel="stylesheet" href="/css/custom.css">
    <link rel="stylesheet" href="/css/normalize.css">
    <link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="/js/jquery-3.5.1.js"></script>
    <script src="/js/bootstrap-3.3.7/dist/js/bootstrap.min.js"></script>
    <!-- <link rel="stylesheet" href="./css/xs1.css"> -->
    
    <style>
.juzhong{
    text-align: center;
    margin-left: 40px;
}
#fm{
    position: absolute;
    left: 750px;
    padding-top: 20px;
}
#fm>samp{
    font-size: 24px;
    color: cadetblue;
    
}
.wo{
    position: absolute;
    left: 48px;
}
.ipl{
    margin-left: 113px;
    padding: 0;
    margin-top: 10px;
    

}
.iplone{
    position: absolute;
    left: 0px;
}
#btnone{
    position: absolute;
    top: 500px;
    left: 850px;
    width: 80px;
}
#btnone2{
    position: absolute;
    top: 500px;
    left: 950px;
    width: 80px;
}
#divimg{
    position: absolute;
    width: 200px;
    height: 200px;
    left: 400px;
    /* border: 1px solid red; */
}
#divimg>img{
    width: 200px;
    height: 200px;
}
/* #imgsamp{
    position: absolute;
    left: 450px;
    top: 300px;
    font-size: 25px;
} */
#file{
    position: absolute;
    left: 400px;
    top: 300px;
    font-size: 15px;
    outline: none;
}
#submit{
    position: absolute;
    left: 400px;
    top: 350px;
}

.row{
    margin-right: 0;
}
#submit:focus{
    outline:0;
}
#btnone:focus{
    outline:0;
}
#btnone2:focus{
    outline:0;

}
input:focus{
    outline:0;
}
#chengjikuang{
    position: absolute;
    width: 200px;
    height: 40px;
    top: 315px;
    left: 1100px;
    background-color: rgb(51, 116, 102);
}
#chengjikuangVal{
    color: hotpink;
    font-size: 20px;
    line-height: 40px;
}
    </style>
</head>
<body>
    <div class="page-wrapper">
        <nav id="sidebar" class="sidebar-wrapper">
          <div class="sidebar-content">
            <a href="#" id="toggle-sidebar"><i class="fa fa-bars"></i></a>
            <div class="sidebar-brand">
                <a href="#">管理系统</a>
            </div>
            <div class="sidebar-header">
                <div class="user-pic">
                    <img  src="/img/touxiang.png" alt="" id="tx">
                </div>
                <div class="user-info">
                    <span class="user-name" id="name">boss</span>
                    <span class="user-role" id="yhm">boss</span>
                    <div class="user-status">                       
                        <span class="label label-success" id="qx">权限</span>                          
                    </div>
                </div>
            </div><!-- sidebar-header  -->
            <div class="sidebar-menu">
                <ul>
                    <li class="header-menu"><span>菜单</span></li>
                    <li><a href="home.html"><i class="fa fa-tv"></i><span>首页</span></a></li>                     
                    <li class="sidebar-dropdown" id="xz">
                        <a href="#"><i class="fa fa-photo"></i><span>boss</span><span class="badge">3</span></a>
                        <div class="sidebar-submenu">
                            <ul>
                                <li><a href="boss1.html">功能一</a></li>
                                <li><a href="boss2.html">功能二</a></li>
                                
                            </ul>
                        </div>
                    </li>
                    <li class="sidebar-dropdown" id="ls">
                        <a href="#"><i class="fa fa-bar-chart-o"></i><span>老师</span></a>
                        <div class="sidebar-submenu">
                            <ul>
                                <li><a href="ls1.html">submenu 1</a></li>
                                
                            </ul>
                        </div>
                    </li>
                    <li class="sidebar-dropdown" id="xs">
                        <a href="#"><i class="fa fa-diamond"></i><span>学生</span></a>
                        <div class="sidebar-submenu">
                            <ul>
                                <li><a href="xs1.html">submenu 1</a></li>
                                
                            </ul>
                        </div>
                    </li>
                    <li class="header-menu"><a href="login.html">退出</a></li>
                </ul>
               </div><!-- sidebar-menu  -->            
            </div><!-- sidebar-content  -->
        </nav><!-- sidebar-wrapper  -->
        <main class="page-content">
            <div class="col-xs-12" >
                <div class="col-xs-12" >
                    <h1 class="juzhong">个人信息资料</h1>
								<div id="divimg">
									<img id="imgoo" src="" alt="">
								</div>
								<!-- <samp id="imgsamp">个人头像</samp> -->
								<input type="file" id="file">
								<button class="btn btn-info" id="submit">
									<i>上传图片</i>
								</button>
							
							<form action="" id="fm">
								<samp class="wo">姓名:</samp>
								<input id="xingming" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<samp class="wo">学号:</samp>
								<input id="xuehao" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<samp class="wo">班级:</samp>
								<input id="banji" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<samp class="wo">性别:</samp>
								<input id="xingbie" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<samp class="wo">成绩:</samp>
								<input id="chengji" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<samp class="wo">年龄:</samp>
								<input id="nianling" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<samp class="wo">专业:</samp>
								<input id="zhuanye" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<samp class="wo">城市:</samp>
								<input id="chegshi" class="ipl" type="text" value="" readonly =“readonly>
							</br>
							</br>
								<!-- <samp>是否党员:</samp>
								<input type="text" value="" readonly =“readonly class="ipl iplone"> -->
							
							</form>
							<button class="btn btn-info" id="btnone">
								<i class="ace-icon fa fa-pencil">修改</i>
							</button>
							<button class="btn btn-info" id="btnone2">
								<i>提交</i>
							</button>
                </div>
                <div id="chengjikuang">
                    <samp id="chengjikuangVal"></samp>
                </div>
            </div>
        </main>
        <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
        <script src="js/custom.js"></script>
        <script src="http://pv.sohu.com/cityjson"></script>
        <script type="text/javascript" src="js/home.js"></script>
        <script>
            

            var student=JSON.parse(localStorage.student)
			// console.log(JSON.parse(localStorage.student))
			// console.log((window.location.href).split('#'))
            // var qx=(window.location.href).split('#')//获取页面#后的用户名
            var quanxian =JSON.parse(localStorage.quanxian);
            var yhm = JSON.parse(localStorage.yonghu);

			// console.log(qx[2])//打印出#后的yhm

			var jishu=0;
			for(var i=0;i<student.length;i++){
					if( yhm== student[i].yhm){
						jishu = i;
						break;
					}
			}
			//调用数据库里的数据到input框内
			$(function(){
				$('#xingming').val(student[jishu].name);//调用该用户数组里的名字到input框内
				$('#xuehao').val(student[jishu].number);//调用该用户数组里的学号到input框内
				$('#banji').val(student[jishu].bj);//调用该用户数组里的班级到input框内
				$('#xingbie').val(student[jishu].sex);//调用该用户数组里的性别到input框内
				$('#nianling').val(student[jishu].age);//调用该用户数组里的年龄到input框内
				$('#zhuanye').val(student[jishu].zhuanye);//调用该用户数组里的专业到input框内
				$('#chegshi').val(student[jishu].city);//调用该用户数组里的城市到input框内
				$('#chengji').val(student[jishu].cheng);//调用该用户数组里的成绩到input框内
			})

			//点击修改后让removeAttr属性取消
			$('#btnone').click(function(){
				$('.ipl:gt(4)').removeAttr('readonly');
			})
			//点击提交后让removeAttr属性生效，并且让修改后的值覆盖到数据库
			$('#btnone2').click(function(){
				student[jishu].age=$('#nianling').val();
				student[jishu].zhuanye=$('#zhuanye').val();
				student[jishu].city=$('#chegshi').val();
				$('.ipl:gt(3)').attr('readonly','readonly');
				localStorage.setItem('student',JSON.stringify(student));
				
			})

			//上传图片功能
			var imgType = ['jpg','jpeg','png'];//图片格式
			$('#submit').click(function(){
				var str = $('#file').val();//得到上传文件的值
				var ext = str.split('.');//在.的地方隔开
				ext = ext[ext.length-1];//取.后面的值
				if(imgType.indexOf(ext.toLowerCase()) > -1){
					var myImg = new FileReader();
					myImg.readAsDataURL($('#file')[0].files[0]);
					myImg.onloadend = function(e){
						console.log(e.target.result);//获取是图片
						$('#imgoo').attr('src',e.target.result)
						student[jishu].tp2=e.target.result;
						localStorage.setItem('student',JSON.stringify(student));
					}

				}else{
					alert('文件格式有问题，请从新选择文件')
				}
            })
            //判断成绩
            var xianshi = student[jishu].cheng;
            if(student[jishu].cheng >= 60 && student[jishu].cheng <=100){
                $('#chengjikuangVal').text('恭喜您已及格');  
            }
            if(student[jishu].cheng < 60){
                $('#chengjikuangVal').text('您未及格，请准备重考');  
            }
        </script>
</body>
</html>