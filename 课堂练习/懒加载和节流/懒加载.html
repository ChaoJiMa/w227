<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>图片懒加载</title>
    <script src="../jquery-3.5.1.min.js" type="text/javascript" ></script>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        div{
            overflow: hidden;
        }
        img {
            display: block;
            margin:5px auto;
            /* border-radius: 20px; */
        }
    </style>
</head>
<body>
    <div>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
        <img src="img/giao.jpg" data-src='img\img1.jpg'>
    </div>
</body>
<script>
    var seeheight = document.documentElement.clientHeight;              //获取屏幕可视区域高度
    var gundongtiao = document.documentElement.scrollTop || document.body.scrollTop;//滚动条距离顶部的高度
    var imgs = document.querySelectorAll('img');                        //获取所有img元素
    window.onscroll = function(){                                       //监听滚动条事件
        for(var i=0;i<imgs.length;i++){
            if(seeheight+gundongtiao>imgs[i].offsetTop){                //图片距离顶部的距离大于可视区域和滚动条到顶部之和时
                (function(i){                                           // 让i立即执行 i每循环一次执行一次
                    setTimeout(function(){                              //用setTimeout指定当他2秒后加载
                        var a = new Image();                            //创建一个临时图像对象，这个图片在内存中不会到页面上去。实现隐形加载
                        a.src = imgs[i].getAttribute('data-src');       //只会请求一次
                        a.onload = function(){                          // onload判断图片加载完毕，真实图片加载完毕，再赋值给dom节点
                            imgs[i].src = imgs[i].getAttribute('data-src')  // 获取自定义属性data-src，用真图片替换假图片
                        }        
                    },2000)
                })(i)
            }
        }
    }
</script>
</html>




